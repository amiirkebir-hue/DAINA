import tkinter as tk
from tkinter import ttk
import requests
from threading import Thread
import os

def download_file(url, filename, progress_bar):
    response = requests.get(url, stream=True)
    total = int(response.headers.get('content-length', 0))
    downloaded = 0
    with open(filename, 'wb') as f:
        for data in response.iter_content(chunk_size=1024):
            f.write(data)
            downloaded += len(data)
            if total > 0:
                progress = int(downloaded * 100 / total)
                progress_bar['value'] = progress
            root.update_idletasks()

def start_download():
    url = url_entry.get()
    filename = filename_entry.get()
    Thread(target=download_file, args=(url, filename, progress)).start()

def set_window_icon_from_url(url):
    """Ø¢ÛŒÚ©ÙˆÙ† Ø±Ø§ Ø§Ø² ÛŒÚ© Ù„ÛŒÙ†Ú© Ø§ÛŒÙ†ØªØ±Ù†ØªÛŒ ØªÙ†Ø¸ÛŒÙ… Ù…ÛŒâ€ŒÚ©Ù†Ø¯"""
    try:
        response = requests.get(url)
        icon_path = "temp_icon.ico"
        with open(icon_path, "wb") as f:
            f.write(response.content)
        root.iconbitmap(icon_path)
        # Ø¨Ø¹Ø¯ Ø§Ø² ØªÙ†Ø¸ÛŒÙ…ØŒ ÙØ§ÛŒÙ„ Ù…ÙˆÙ‚Øª Ø±Ø§ Ø­Ø°Ù Ú©Ù† (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
        os.remove(icon_path)
    except Exception as e:
        print("Ø®Ø·Ø§ Ø¯Ø± ØªÙ†Ø¸ÛŒÙ… Ø¢ÛŒÚ©ÙˆÙ†:", e)

root = tk.Tk()
root.title("Download Manager")

# ğŸ¨ Ù„ÛŒÙ†Ú© Ø¢ÛŒÚ©ÙˆÙ† (Ù„Ø·ÙØ§Ù‹ Ù„ÛŒÙ†Ú© .ico Ø¯Ù„Ø®ÙˆØ§Ù‡Øª Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ú¯Ø°Ø§Ø±)
icon_url = "https://raw.githubusercontent.com/amiirkebir-hue/DAINA/refs/heads/main/channels4_profile_imresizer.ico"
set_window_icon_from_url(icon_url)

# Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ
tk.Label(root, text="URL:").pack()
url_entry = tk.Entry(root, width=50)
url_entry.pack()

tk.Label(root, text="Filename:").pack()
filename_entry = tk.Entry(root, width=50)
filename_entry.pack()

progress = ttk.Progressbar(root, length=400)
progress.pack(pady=10)

tk.Button(root, text="Download", command=start_download).pack()

root.mainloop()
